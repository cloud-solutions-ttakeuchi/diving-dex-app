# 実機検証用ネイティブビルド計画 (v5.0.0)

## 1. 目的
Expo Development Build（EAS Build）を導入し、開発者の実機（iPhone）に WeDive アプリをインストール可能にする。シミュレーターでは検証できない「正確なパフォーマンス」「ネイティブモジュールの安定性」「実地での操作感」を全機能にわたって検証する。

## 2. 実装フェーズ

### フェーズ 1: EAS 環境構築
- **内容**: 
  - `eas-cli` の整合性確認。
  - `eas.json` を作成し、開発用 (development) と本番用 (production) のプロファイルを定義。
  - `app.json` (Expo Config) にネイティブビルド用の識別子（Bundle Identifier等）を設定。
- **目標**: `eas build` コマンドがエラーなく受け付けられる状態にする。

### フェーズ 2: Apple Developer 連携 (ユーザー主導)
- **内容**:
  - Apple Developer Program への登録完了を確認。
  - Apple ID を Expo プロジェクトに紐付け、証明書 (Credentials) を自動生成。
- **目標**: iOS 実機への配布に必要なプロビジョニングファイルを EAS 上で管理可能にする。

### フェーズ 3: 開発用ビルド (Development Build) の作成
- **内容**:
  - `eas build --profile development --platform ios` の実行。
  - `expo-dev-client` を利用したインストール用 QR コードの生成。
- **目標**: 開発者の iPhone に WeDive アイコンが表示され、起動できること。

### フェーズ 4: 実機機能検証 (QA)
- **内容**:
  - **データ取得**: `usePoints`, `useCreatures` 等の React Query フックが実機の通信環境でスムーズに動くか。
  - **マスタリー計算**: 昨晩復元した「ポイント攻略率」の計算が実機で快適に動くか。
  - **オフライン動作**: 本格的な圏外環境を想定したキャッシュ動作の再確認。
- **目標**: 実機ならではのバグ（表示崩れ、メモリ不足、GPS精度等）を洗い出し修正する。

---

## 3. 具体的な工程

1.  **設定ファイル作成**: `eas.json` と `app.json` の更新。
2.  **依存関係の整理**: ネイティブビルドに不要なライブラリの削除と、`expo-dev-client` の導入。
3.  **CI/CD 連携**: EAS Build の結果を自動的に管理画面等で追跡可能にする（将来検討）。

## 4. 完了定義 (Definition of Done)
- [ ] `eas.json` が適切に設定されている。
- [ ] 開発者の実機にアプリがインストールされている。
- [ ] 実機上でログイン、ログ閲覧、ポイント検索が正常に行える。
- [ ] 実機でのマスタリー計算パフォーマンスに問題がない。
- [ ] `INFRASTRUCTURE.md` にビルドフローが追記されている。
